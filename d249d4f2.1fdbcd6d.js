(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{139:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return b}));var a=n(2),r=n(6),c=(n(0),n(147)),i={id:"v0-10-api-migration",title:"v0.10 API Migration"},o={id:"v0-10-api-migration",title:"v0.10 API Migration",description:"The Draft.js v0.10 release includes a change to the API for managing",source:"@site/../docs/APIReference-APIMigration.md",permalink:"/docs/v0-10-api-migration",editUrl:"https://github.com/facebook/draft-js/edit/master/docs/../docs/APIReference-APIMigration.md",lastUpdatedBy:"Kevin Chavez",lastUpdatedAt:1602806902,sidebar:"docs",previous:{title:"Entities",permalink:"/docs/advanced-topics-entities"},next:{title:"Decorators",permalink:"/docs/advanced-topics-decorators"}},l=[{value:"Quick Overview",id:"quick-overview",children:[{value:"Creating an Entity",id:"creating-an-entity",children:[]},{value:"Getting an Entity",id:"getting-an-entity",children:[]},{value:"Decorator strategy arguments change",id:"decorator-strategy-arguments-change",children:[]},{value:"Decorator Strategies that find Entities",id:"decorator-strategies-that-find-entities",children:[]}]},{value:"More Information",id:"more-information",children:[]}],s={rightToc:l};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"The Draft.js v0.10 release includes a change to the API for managing\n",Object(c.b)("inlineCode",{parentName:"p"},"DraftEntity")," data; the global 'DraftEntity' module is being deprecated and\n",Object(c.b)("inlineCode",{parentName:"p"},"DraftEntity")," instances will be managed as part of ",Object(c.b)("inlineCode",{parentName:"p"},"ContentState"),". This means\nthat the methods which were previously accessed on ",Object(c.b)("inlineCode",{parentName:"p"},"DraftEntity")," are now moved\nto the ",Object(c.b)("inlineCode",{parentName:"p"},"ContentState")," record."),Object(c.b)("p",null,"The old API was set to be permanently removed in v0.11, but will now be removed in v0.12. Make sure to migrate over!"),Object(c.b)("p",null,"This API improvement unlocks the path for many benefits that will be available in v0.12:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"DraftEntity instances and storage will be immutable."),Object(c.b)("li",{parentName:"ul"},"DraftEntity will no longer be globally accessible."),Object(c.b)("li",{parentName:"ul"},"Any changes to entity data will trigger a re-render.")),Object(c.b)("h2",{id:"quick-overview"},"Quick Overview"),Object(c.b)("p",null,"Here is a quick list of what has been changed and how to update your application:"),Object(c.b)("h3",{id:"creating-an-entity"},"Creating an Entity"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Old Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const entityKey = Entity.create(urlType, 'IMMUTABLE', {src: urlValue});\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"New Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const contentStateWithEntity = contentState.createEntity(urlType, 'IMMUTABLE', {\n  src: urlValue,\n});\nconst entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n")),Object(c.b)("h3",{id:"getting-an-entity"},"Getting an Entity"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Old Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const entityInstance = Entity.get(entityKey);\n// entityKey is a string key associated with that entity when it was created\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"New Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const entityInstance = contentState.getEntity(entityKey);\n// entityKey is a string key associated with that entity when it was created\n")),Object(c.b)("h3",{id:"decorator-strategy-arguments-change"},"Decorator strategy arguments change"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Old Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const compositeDecorator = new CompositeDecorator([\n  {\n    strategy: (contentBlock, callback) =>\n      exampleFindTextRange(contentBlock, callback),\n    component: ExampleTokenComponent,\n  },\n]);\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"New Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const compositeDecorator = new CompositeDecorator([\n  {\n    strategy: (contentBlock, callback, contentState) => (\n      contentBlock, callback, contentState\n    ),\n    component: ExampleTokenComponent,\n  },\n]);\n")),Object(c.b)("p",null,"Note that ExampleTokenComponent will receive contentState as a prop."),Object(c.b)("p",null,"Why does the 'contentState' get passed into the decorator strategy now? Because we may need it if our strategy is to find certain entities in the contentBlock:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const mutableEntityStrategy = function(contentBlock, callback, contentState) {\n  contentBlock.findEntityRanges(character => {\n    const entityKey = character.getEntity();\n    if (entityKey === null) {\n      return false;\n    }\n    // To look for certain types of entities,\n    // or entities with a certain mutability,\n    // you may need to get the entity from contentState.\n    // In this example we get only mutable entities.\n    return contentState.getEntity(entityKey).getMutability() === 'MUTABLE';\n  }, callback);\n};\n")),Object(c.b)("h3",{id:"decorator-strategies-that-find-entities"},"Decorator Strategies that find Entities"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Old Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"function findLinkEntities(contentBlock, callback) {\n  contentBlock.findEntityRanges(character => {\n    const entityKey = character.getEntity();\n    return entityKey !== null && Entity.get(entityKey).getType() === 'LINK';\n  }, callback);\n}\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"New Syntax")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"function findLinkEntities(contentBlock, callback, contentState) {\n  contentBlock.findEntityRanges(character => {\n    const entityKey = character.getEntity();\n    return (\n      entityKey !== null &&\n      contentState.getEntity(entityKey).getType() === 'LINK'\n    );\n  }, callback);\n}\n")),Object(c.b)("h2",{id:"more-information"},"More Information"),Object(c.b)("p",null,"See the ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/facebook/draft-js/tree/master/examples/draft-0-10-0"}),"updated examples"),"."))}b.isMDXComponent=!0},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),b=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=b(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},y=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=b(n),y=a,d=p["".concat(i,".").concat(y)]||p[y]||u[y]||c;return n?r.a.createElement(d,o(o({ref:t},s),{},{components:n})):r.a.createElement(d,o({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,i=new Array(c);i[0]=y;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var s=2;s<c;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}y.displayName="MDXCreateElement"}}]);